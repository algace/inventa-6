<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=11">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		
		<!--/* INICIO - CSS */-->
		<link rel="stylesheet" type="text/css" th:href="@{/webjars/bootstrap/4.4.1/css/bootstrap.min.css}">
		<link rel="stylesheet" type="text/css" th:href="@{/webjars/font-awesome/5.13.0/css/all.css}">
		<link rel="stylesheet" type="text/css" th:href="@{/webjars/tempusdominus-bootstrap-4/5.1.2/css/tempusdominus-bootstrap-4.min.css}">
		<link rel="stylesheet" type="text/css" th:href="@{/webjars/datatables.net-bs4/css/dataTables.bootstrap4.min.css}">
		<link rel="stylesheet" type="text/css" th:href="@{/webjars/datatables.net-select-bs4/css/select.bootstrap4.min.css}">
		
		<link rel="stylesheet" type="text/css" th:href="@{/css/menu.css}">
		<link rel="stylesheet" type="text/css" th:href="@{/css/breadcrumb.css}">
		<link rel="stylesheet" type="text/css" th:href="@{/css/formulario.css}">
		<link rel="stylesheet" type="text/css" th:href="@{/css/botoneraTabla.css}">
		<link rel="stylesheet" type="text/css" th:href="@{/css/dataTable.css}">
		<!--/* FIN - CSS */-->
		
		<link rel="shortcut icon" type="image/png" th:href="@{/images/anagrama_inventa.png}">	
	</head>
	<body class="bg-white">

		<div class="container-fluid">
		
			<!--/* INICIO - Cabecera */-->
			<div th:replace="fragments/cabecera :: cabecera"></div>
			<!--/* FIN - Cabecera */-->
			
			<!--/* INICIO - Contenido */-->
			<div class="row">
				<div class="offset-sm-1 col-auto">
				
					<!--/* INICIO - Menú */-->
					<div th:replace="fragments/menu :: menu"></div>
					<!--/* FIN - Menú */-->
				
				</div>
				<div class="col-sm-8">
				
					<!--/* INICIO - Migas de pan */-->
					<nav aria-label="breadcrumb">
						<ol class="breadcrumb">
					    	<li class="breadcrumb-item"><a href="#" class="breadcrumb-a" th:text="#{html.menu.gestionBBDD}"></a></li>
					    	<li class="breadcrumb-item"><a href="#" class="breadcrumb-a" th:text="#{html.menu.controlVersionesSW}"></a></li>
					    	<li class="breadcrumb-item"><a class="breadcrumb-a" th:href="@{${volver}}" th:text="#{html.menu.aplicacionesSW}"></a></li>
					    	<li class="breadcrumb-item active" aria-current="page" th:text="#{html.menu.aplicacionSW}"></li>
					  	</ol>
					</nav>
					<!--/* FIN - Migas de pan */-->
		
					<form action="#" th:action="@{${action}}" th:object="${aplicacionSW}" method="post" novalidate>
						<input type="hidden" th:field="*{id}">
								
						<div id="accordionFormulario" class="accordionFormulario">
						
							<!--/* INICIO - Información general */-->
							<div class="card">
								<div id="headingInformacionGeneral" class="card-header">
									<button id="idInformacionGeneral" type="button" class="btn" data-toggle="collapse" data-target="#collapseInformacionGeneral"  
									aria-expanded="true" aria-controls="collapseInformacionGeneral">
										<div style="display:flex;">
											<div class="text-tab-accordion" ><span th:text="#{html.label.informacionGeneral}"></span></div  >
											<div class="icon-tab-accordion"><i class="fas fa-sort-down"></i></div >
										</div >
									</button>
								</div>							
								<div id="collapseInformacionGeneral" class="collapse show" aria-labelledby="headingInformacionGeneral" data-parent="#accordionFormulario">
									<div class="card-body formulario-padding">
										<div class="row  align-items-center">
											<div class="col-sm-2" th:text="#{html.label.nombre}"></div>
									        <div class="col-sm-6">
									            <input id="nombre" type="text"
									            	th:class="${esCampoSoloLectura} ? 'form-control' : 'form-control campo-obligatorio'"
									            	th:field="*{nombre}" th:disabled="${esCampoSoloLectura} ? 'true'"> 
									            <div class="alert alert-danger" role="alert" th:if="${#fields.hasErrors('nombre')}" th:errors="*{nombre}"></div>
									        </div>										        	
		       							 </div>
		       							 <div class="row  align-items-center">
											<div class="col-sm-2" th:text="#{html.label.archivo}"></div> 
									        <div class="col-sm-6">
									            <input id="archivo" type="text" 
									            	th:field="*{archivo}" th:class="${esCampoSoloLectura} ? 'form-control' : 'form-control campo-obligatorio'" 
									            	th:disabled="${esCampoSoloLectura} ? 'true'">
									            <div class="alert alert-danger" role="alert" th:if="${#fields.hasErrors('archivo')}" th:errors="*{archivo}"></div>
									        </div>	
		       							 </div>							
		       							 <div class="row align-items-center">
											<div class="col-sm-2" th:text="#{html.label.fecha}"></div>
											<div class="col-sm-6">
								                <div class="input-group date" id="datetimepickerFecha" data-target-input="nearest">
								                    <input type="text" data-target="#datetimepickerFecha" 
								                    	th:class="${esCampoSoloLectura} ? 'form-control' : 'form-control campo-obligatorio'"
								                    	th:field="*{fecha}" th:disabled="${esCampoSoloLectura} ? 'true'"/>
								                    <div class="input-group-append" data-target="#datetimepickerFecha" data-toggle="datetimepicker">
								                        <div class="input-group-text"><i class="far fa-calendar"></i></div>
								                    </div>
								                </div>
									            <div class="alert alert-danger" role="alert" th:if="${#fields.hasErrors('fecha')}" th:errors="*{fecha}"></div>
									        </div>
		       							 </div>		       							 
		       							 <div class="row align-items-center">
											<div class="col-sm-2" th:text="#{html.label.hora}"></div> 
									        <div class="col-sm-6">
								                <div class="input-group date" id="datetimepickerHora" data-target-input="nearest">
								                    <input type="text" data-target="#datetimepickerHora" 
								                    	th:class="${esCampoSoloLectura} ? 'form-control' : 'form-control campo-obligatorio'"
								                    	th:field="*{hora}" th:disabled="${esCampoSoloLectura} ? 'true'"/>
								                    <div class="input-group-append" data-target="#datetimepickerHora" data-toggle="datetimepicker">
								                        <div class="input-group-text"><i class="far fa-clock"></i></div>
								                    </div>
								                </div>
									            <div class="alert alert-danger" role="alert" th:if="${#fields.hasErrors('hora')}" th:errors="*{hora}"></div>
									        </div>	
		       							 </div>							
									</div>
								</div>
							</div>
							<!--/* FIN - Información general */-->
							
							<!--/* INICIO - Equipamiento */-->	
							<div class="card">
								<div id="headingEquipamiento" class="card-header">
									<button type="button" class="btn collapsed" data-toggle="collapse" data-target="#collapseEquipamiento" aria-expanded="false"
										aria-controls="collapseEquipamiento">
										<div style="display:flex;">
											<div class="text-tab-accordion" ><span th:text="#{html.label.equipamientos}"></span></div  >
											<div class="icon-tab-accordion"><i class="fas fa-sort-down"></i></div >
										</div >
									</button>
								</div>
								<div id="collapseEquipamiento" class="collapse" aria-labelledby="headingEquipamiento" data-parent="#accordionFormulario">
									<div class="card-body">
									
										<!--<div align="left" th:hidden="${esCampoSoloLectura} ? 'true'">	
											<a id="enlaceAgnadirEquipamiento" role="button" class="btn btn-primary"
												th:text="#{html.boton.agnadir}" th:href="@{${agnadir}}"></a>	
											<button id="botonBorrarEquipamiento" class="btn btn-primary" disabled
												th:text="#{html.boton.borrar}"></button>	
										</div>-->	
										
										<!--<br th:hidden="${esCampoSoloLectura} ? 'true'">-->
										<div th:replace="fragments/botoneraTablaFormulario :: botoneraTablaFormulario(popupTarget='#popupSeleccionarEquipamiento', idButtonBorrar='botonBorrarEquipamiento')"></div>
										
										<table id="tablaEquipamiento" class="table table-striped table-bordered no-margin-top" style="width: 100%">
											<thead>
												<tr>
													<th class="th-sm" th:text="#{html.tabla.cabecera.nombre}"></th>
													<th class="th-sm" th:text="#{html.tabla.cabecera.marca}"></th>
													<th class="th-sm" th:text="#{html.tabla.cabecera.modelo}"></th>
													<th class="th-sm" th:text="#{html.tabla.cabecera.entradas}"></th>
													<th class="th-sm" th:text="#{html.tabla.cabecera.salidas}"></th>
													<th class="th-sm" th:text="#{html.tabla.cabecera.ganancia}"></th>
													<th class="th-sm" th:text="#{html.tabla.cabecera.perdida}"></th>
												</tr>
											</thead>
											<tbody>
												<tr th:each="equipamiento, item : *{equipamientos}">
													<td th:text="${equipamiento.nombre}"></td>
													<td th:text="${equipamiento.marca}"></td>
													<td th:text="${equipamiento.modelo}"></td>
													<td th:text="${equipamiento.entradas}"></td>
													<td th:text="${equipamiento.salidas}"></td>
													<td th:text="${#numbers.formatDecimal(equipamiento.ganancia, 0, 'POINT', 2, 'COMMA')}"></td>
													<td th:text="${#numbers.formatDecimal(equipamiento.perdida, 0, 'POINT', 2, 'COMMA')}"></td>
													<input type="hidden" th:field="*{equipamientos[__${item.index}__].id}">
													
												</tr>
											</tbody>
										</table>
									</div>
								</div>
							</div>
							<!--/* FIN - Equipamiento */-->
							
							<!--/* INICIO - Versiones */-->
							<div class="card">
								<div id="headingVersiones" class="card-header">
									<button type="button" class="btn collapsed" data-toggle="collapse" data-target="#collapseVersiones" aria-expanded="false"
										aria-controls="collapseVersiones">
										<div style="display:flex;">
											<div class="text-tab-accordion" ><span th:text="#{html.label.versionesSW}"></span></div  >
											<div class="icon-tab-accordion"><i class="fas fa-sort-down"></i></div >
										</div >
									</button>
								</div>
								<div id="collapseVersiones" class="collapse" aria-labelledby="headingVersiones" data-parent="#accordionFormulario">
									<div class="card-body">
										<!--<div align="left" th:hidden="${esCampoSoloLectura} ? 'true'">	

											<a id="enlaceAgnadirVersion" role="button" class="btn btn-primary" data-toggle="modal" data-target="#popupSeleccionarVersion" href="#"
												th:text="#{html.boton.agnadirVersion}"></a>	
								
											<button id="botonBorrarVersion" type="button" class="btn btn-primary" disabled
												th:text="#{html.boton.borrarVersion}"></button>	
											
										</div>
											
										<br th:hidden="${esCampoSoloLectura} ? 'true'">-->
										
										<div th:replace="fragments/botoneraTablaFormulario :: botoneraTablaFormulario(popupTarget='#popupSeleccionarVersion', idButtonBorrar='botonBorrarVersion')"></div>
										
										<table id="tablaVersiones" class="table table-striped table-bordered no-margin-top" style="width:100%">
											<thead>
												<tr>
													<th class="th-sm" th:text="#{html.tabla.cabecera.nombre}"></th>
													<th class="th-sm" th:text="#{html.tabla.cabecera.descripcion}"></th>
												</tr>
											</thead>
											<tbody>
												<tr th:each="versionSW, item : *{versionesSW}">
													<td th:text="${versionSW.nombre}"></td>
													<td th:text="${versionSW.descripcion}"></td>
													<input type="hidden" th:field="*{versionesSW[__${item.index}__].id}"> 
												</tr>
											</tbody>
										</table>
									</div>
								</div>
							</div>
							<!--/* FIN - Versiones */-->
							
						</div>
						
						<br>
						
						<!--/* INICIO - Botonera */-->
						<div align="right">						
							<!--/* Botón Volver */-->
							<a role="button" class="btn btn-primary" 
								th:text="#{html.boton.volver}" th:href="@{${volver}}"></a>

							<!--/* Botón Cancelar */-->							
							<a role="button" class="btn btn-secondary" data-toggle="modal" data-target="#popupCancelar" href="#"
								th:text="#{html.boton.cancelar}" th:hidden="${estaBotonCancelarActivo} ? 'false' : 'true'"></a>

							<!--/* Botón Aceptar */-->							
							<input type="submit" class="btn btn-primary" 
								th:value="#{html.boton.aceptar}" th:hidden="${estaBotonAceptarActivo} ? 'false' : 'true'">

							<!--/* Botón Eliminar */-->							
							<a role="button" class="btn btn-primary" data-toggle="modal" data-target="#popupEliminar" href="#"
								th:text="#{html.boton.eliminar}" th:hidden="${estaBotonEliminarActivo} ? 'false' : 'true'"></a>
						</div>
						<!--/* FIN - Botonera */-->
						
						<!--/* INICIO - Popup de cancelar */-->
						<div th:replace="fragments/popups/popupCancelar :: popupCancelar"></div>
						<!--/* FIN - Popup de cancelar */-->
						
						<!--/* INICIO - Popup de eliminación */-->
						<div th:replace="fragments/popups/popupEliminar :: popupEliminar"></div>
						<!--/* FIN - Popup de eliminación */-->
						
						<!--/* INICIO - Popup de selección de Equipamiento */-->
						<div id="popupSeleccionarEquipamiento" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modalSeleccionarEquipamiento" aria-hidden="true">
							<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
								<div class="modal-content">
									<div class="modal-header">
								        <h5 id="modalSeleccionarEquipamiento" class="modal-title" th:text="#{html.label.equipamientos}"></h5>
								        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
								        	<span aria-hidden="true"><i class="far fa-times-circle" aria-hidden="true"></i></span>
								        </button>
								    </div>
								    <div class="modal-body">
								    	<table id="tablaSeleccionarEquipamientos" class="table table-striped table-bordered" style="width:100%">
											<thead>
												<tr>
													<!-- <th class="th-sm"></th> -->
													<th class="th-sm" th:text="#{html.tabla.cabecera.nombre}"></th>
													<th class="th-sm" th:text="#{html.tabla.cabecera.marca}"></th>
													<th class="th-sm" th:text="#{html.tabla.cabecera.modelo}"></th>
													<th class="th-sm" th:text="#{html.tabla.cabecera.entradas}"></th>
													<th class="th-sm" th:text="#{html.tabla.cabecera.salidas}"></th>
													<th class="th-sm" th:text="#{html.tabla.cabecera.ganancia}"></th>
													<th class="th-sm" th:text="#{html.tabla.cabecera.perdida}"></th>
												</tr>
											</thead>
											<tbody>
												<tr th:each="equipamientoNoIncluido, item : *{equipamientosNoIncluidos}">
													<td th:text="${equipamientoNoIncluido.nombre}"></td>
													<td th:text="${equipamientoNoIncluido.marca}"></td>
													<td th:text="${equipamientoNoIncluido.modelo}"></td>
													<td th:text="${equipamientoNoIncluido.entradas}"></td>
													<td th:text="${equipamientoNoIncluido.salidas}"></td>
													<td th:text="${#numbers.formatDecimal(equipamientoNoIncluido.ganancia, 0, 'POINT', 2, 'COMMA')}"></td>
													<td th:text="${#numbers.formatDecimal(equipamientoNoIncluido.perdida, 0, 'POINT', 2, 'COMMA')}"></td>
													<input type="hidden" th:field="*{equipamientosNoIncluidos[__${item.index}__].id}"> 
												</tr>
											</tbody>
										</table>
								    </div>
								    <div class="modal-footer">
								        <button id="botonAceptarSeleccionarEquipamiento" type="button" class="btn btn-primary" data-dismiss="modal" disabled 
								        	th:text="#{html.boton.aceptar}"></button>
								        <button type="button" class="btn btn-secondary" data-dismiss="modal" th:text="#{html.boton.cancelar}"></button>
								    </div>
								</div>
							</div>
						</div>
						<!--/* FIN - Popup de selección de Equipamiento */-->
						
						<!--/* INICIO - Popup de selección de versión */-->
						<div id="popupSeleccionarVersion" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modalSeleccionarVersionTitulo" aria-hidden="true">
							<div class="modal-dialog modal-dialog-centered modal-lg" role="document">
								<div class="modal-content">
									<div class="modal-header">
								        <h5 id="modalSeleccionarVersionTitulo" class="modal-title" th:text="#{html.label.versionesSW}"></h5>
								        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
								        	<span aria-hidden="true"><i class="far fa-times-circle" aria-hidden="true"></i></span>
								        </button>
								    </div>
								    <div class="modal-body">
								    	<table id="tablaSeleccionarVersion" class="table table-striped table-bordered" style="width:100%">
											<thead>
												<tr>
													<!-- <th class="th-sm"></th> -->
													<th class="th-sm" th:text="#{html.tabla.cabecera.nombre}"></th>
													<th class="th-sm" th:text="#{html.tabla.cabecera.descripcion}"></th>
												</tr>
											</thead>
											<tbody>
												<tr th:each="versionSWNoIncluida, item : *{versionesSWNoIncluidas}">
													<!-- <td th:text="${versionNoIncluida.id}"></td> -->
													<td th:text="${versionSWNoIncluida.nombre}"></td>
													<td th:text="${versionSWNoIncluida.descripcion}"></td>
													<input type="hidden" th:field="*{versionesSWNoIncluidas[__${item.index}__].id}"> 
												</tr>
											</tbody>
										</table>
								    </div>
								    <div class="modal-footer">
								        <button id="botonAceptarSeleccionarVersion" type="button" class="btn btn-primary" data-dismiss="modal" disabled 
								        	th:text="#{html.boton.aceptar}"></button>
								        <button type="button" class="btn btn-secondary" data-dismiss="modal" th:text="#{html.boton.cancelar}"></button>
								    </div>
								</div>
							</div>
						</div>
						<!--/* FIN - Popup de selección de versión */-->
			
					</form>
				</div>
			</div>
			<!--/* FIN - Contenido */-->
			
			<!--/* INICIO - Pie de página */-->
			<div th:replace="fragments/pie :: pie"></div>
			<!--/* FIN - Pie de página */-->	
			
		</div>

		<!--/* INICIO - JS */-->
		<script type="text/javascript" th:src="@{/webjars/jquery/3.4.1/jquery.min.js}"></script>
		<script type="text/javascript" th:src="@{/webjars/bootstrap/4.4.1/js/bootstrap.min.js}"></script>
		<script type="text/javascript" th:src="@{/webjars/momentjs/2.24.0/min/moment-with-locales.min.js}"></script>
		<script type="text/javascript" th:src="@{/webjars/tempusdominus-bootstrap-4/5.1.2/js/tempusdominus-bootstrap-4.min.js}"></script>	
		<script type="text/javascript" th:src="@{/webjars/datatables.net/js/jquery.dataTables.min.js}"></script>			
		<script type="text/javascript" th:src="@{/webjars/datatables.net-select/js/dataTables.select.min.js}"></script>
		<script type="text/javascript" th:src="@{/webjars/datatables.net-bs4/js/dataTables.bootstrap4.min.js}"></script>
		<script type="text/javascript" th:src="@{/webjars/datatables.net-select-bs4/js/select.bootstrap4.min.js}"></script>
		<script type="text/javascript" th:src="@{/js/aplicacionSW.js}"></script>
		
		<!--/* INICIO - Apertura del menú */-->
		<script th:inline="javascript">
			$('#collapseControlVersionesSW, #collapseGestionBBDD').collapse('show', { "animation": false });
		</script>
		<!--/* FIN - Apertura del menú */-->
		<!--/* FIN - JS */-->
	
	</body>
</html>